メニューのつくりかた

もともと階層構造のメニューを用意しているわけではないのですが、
別なページを読み込むことで階層のあるようなメニューをつくるこ
とができます。

再生方法の個所に "MENU" と大文字で記述すると、その項目はメニュー
と判断し、別な局リストを読み込みます。その際、ファイル名は局
の識別子の個所に書きます。局表示と同じに扱いますのでアイコン
も使えます。

例えばトップを以下のようにし、このファイル名がmenu_listとしま
す。

stations/am_list,AMラジオ,AM RADIO,SYS_AM.png,MENU
stations/fm_list,FMラジオ,FM RADIO,SYS_FM.png,MENU
stations/sw_list,短波ラジオ,SW RADIO,SYS_SW.png,MENU

『次』のファイルのパスは起動した位置からの相対か、あるいは絶
対パスでもかまいません。このメニューでトップは上の3項目となり
ますので、次にそれぞれの局リストを作ります。例えばam_listは以
下のようにします。

TBS,TBSラジオ,TBS RADIO,TBS.png,radiko
QRR,文化放送,JOQR BUNKA HOSO,QRR.png,radiko
LFR,ニッポン放送,JOLF NIPPON HOSO,LFR.png,radiko
JORF,ラジオ日本,RF RADIO NIPPON,JORF.png,radiko
JOAK,NHKラジオ第1（東京）,JOAK,JOAK.png,radiko
stations/menu_list,戻る,TOP,SYS_MENU.png,MENU

ポイントは『戻り』のファイル名を指定することです。最後の1行で
メニュー項目として元のファイル(menu_list)を指していますので、
これを選択することでトップに戻れます。
あたりまえですが、これを指定しわすれると元に戻れません。

起動あるいはリロード時に使用するメニュー(局リスト)はソース内
で固定されています。違う名前を使いたい場合には以下を修正して
ください。

# 局設定リストのファイル
station_file = 'stations/station_list'


なおGPIO割込みが2重検出される問題があるため再生(実行)ボタンは
4～5秒のガードタイムが設けてあります。このためメニュー間の移動
もガードタイム内は行えないという欠点があります。もし、使用して
いる環境で2重検出が起こらないようならガードタイムを短くするな
りしてください。

    # ガードタイムはこの処理(0.5+3) +0.5で設定
    guard_time = 4

の個所です。この問題どうもPythonの問題で『なおらん！』というの
を海外掲示板で見つけたので深く追求するのはやめました。

*若干バギーな気もしているので変な指定をすると固まるかも。

